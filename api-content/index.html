{"posts":[{"title":"luogu P2791 幼儿园篮球题","content":"luogu P2791 幼儿园篮球题 快速阅读完题面，发现其实就是求下面这个式子： ∑i=1kCmiCn−mk−iiL\\sum\\limits_{i=1}^{k}{C_m^i C_{n-m}^{k-i} i^L} i=1∑k​Cmi​Cn−mk−i​iL 发现组合数其实可以递推预处理，麻烦的就是这个 iLi^LiL 式子 利用第二类斯特林数拆分一下 iL=∑j=0iCij{Lj}j!i^L=\\sum\\limits_{j=0}^i{C_i^j \\begin{Bmatrix}L\\\\j\\end{Bmatrix} j!} iL=j=0∑i​Cij​{Lj​}j! 代入进去变成 ∑i=1kCmiCn−mk−i∑j=0iCij{Lj}j!\\sum\\limits_{i=1}^{k}{C_m^i C_{n-m}^{k-i} \\sum\\limits_{j=0}^i{C_i^j \\begin{Bmatrix}L\\\\j\\end{Bmatrix} j!}} i=1∑k​Cmi​Cn−mk−i​j=0∑i​Cij​{Lj​}j! 把 ∑\\sum∑ 交换一下变成 ∑j=0k{Lj}j!∑i=jkCmiCn−mk−iCij\\sum\\limits_{j=0}^k{\\begin{Bmatrix}L\\\\j\\end{Bmatrix} j! \\sum\\limits_{i=j}^k{C_m^i C_{n-m}^{k-i} C_i^j}} j=0∑k​{Lj​}j!i=j∑k​Cmi​Cn−mk−i​Cij​ 通过 CmiCij=CmjCm−ji−jC_m^i C_i^j = C_m^j C_{m-j}^{i-j}Cmi​Cij​=Cmj​Cm−ji−j​ 这个式子将后面的三个组合数拿出来一个到前面 ∑j=0k{Lj}j!Cmj∑i=jkCm−ji−jCn−mk−i\\sum\\limits_{j=0}^k{\\begin{Bmatrix}L\\\\j\\end{Bmatrix} j! C_m^j \\sum\\limits_{i=j}^k{C_{m-j}^{i-j} C_{n-m}^{k-i}}} j=0∑k​{Lj​}j!Cmj​i=j∑k​Cm−ji−j​Cn−mk−i​ 我们换个元，设 t=i−jt=i-jt=i−j，则式子变为 ∑j=0k{Lj}j!Cmj∑t=0k−jCm−jtCn−mk−j−t\\sum\\limits_{j=0}^k{\\begin{Bmatrix}L\\\\j\\end{Bmatrix} j! C_m^j \\sum\\limits_{t=0}^{k-j}{C_{m-j}^t C_{n-m}^{k-j-t}}} j=0∑k​{Lj​}j!Cmj​t=0∑k−j​Cm−jt​Cn−mk−j−t​ 通过观察组合数和求和的次数，可以发现可以套用范德蒙德卷积化简 ∑i=0kCniCmk−i=Cn+mk⇒∑t=0k−jCm−jtCn−mk−j−t=Cn−jk−j\\sum\\limits_{i=0}^k{C_n^i C_m^{k-i}} = C_{n+m}^k \\Rightarrow \\sum\\limits_{t=0}^{k-j}{C_{m-j}^t C_{n-m}^{k-j-t}} = C_{n-j}^{k-j} i=0∑k​Cni​Cmk−i​=Cn+mk​⇒t=0∑k−j​Cm−jt​Cn−mk−j−t​=Cn−jk−j​ 所以式子化为 ∑j=0k{Lj}j!CmjCn−jk−j\\sum\\limits_{j=0}^k{\\begin{Bmatrix}L\\\\j\\end{Bmatrix} j! C_m^j C_{n-j}^{k-j}} j=0∑k​{Lj​}j!Cmj​Cn−jk−j​ 可以将第二类斯特林数和组合数预处理，然后不难发现上面枚举的 jjj 的上限是 min(k,L,m)=O(L)min(k,L,m)=O(L)min(k,L,m)=O(L)，所以每次询问复杂度为 O(L)O(L)O(L)，即可通过此题 ","link":"http://localhost:4000/post/luogu-p2791-you-er-yuan-lan-qiu-ti/"},{"title":"10.18","content":". ","link":"http://localhost:4000/post/1018/"}]}